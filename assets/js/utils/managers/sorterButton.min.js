import {selectorTypes as a} from'../../config.js';import {aria as b} from'../accessibility/aria.js';import {focusFirst as c,createFocusCycle as d,} from'../accessibility/focus.js';import {handlers as e,events as f,} from'../accessibility/keyboard.js';let g=(A,_)=>A.find(B=>b.isSelected(B))||A.find(C=>!b.isDisabled(C))||c(_,a.sortOptions);export let createSorterButton=({button:_a,optionsContainer:_b,options:_c,onSelect:D,onClose:E,orientation:F='vertical'})=>{let G=!1,h=null,i={currentIndex:0,open(){G=!0;b.setExpanded(_a,!0);b.toggleVisibility(_b,!0);g(_c,_b)?.focus();h=d(_b,a.sortOptions)},close(){G=!1;b.setExpanded(_a,!1);b.toggleVisibility(_b,!1);h?.();h=null;_a?.focus();E?.()},toggle(){G?i.close():i.open()},select(_A){if(!_A)return;b.setSelected(_c,_A);D?.(_A);i.close()},destroy(){h?.();h=null;_b.removeEventListener('keydown',j);document.removeEventListener('keydown',k)}},j=e.createArrowNavigation({elements:_c,orientation:F,onNavigate:aA=>i.currentIndex=_c.findIndex(opt=>opt===aA),onActivate:aB=>i.select(aB)}),k=e.createEscapeHandler(()=>i.close());_a.addEventListener('click',f.createClickHandler(()=>i.toggle()));_b.addEventListener('keydown',j);document.addEventListener('keydown',k);for(const aC of _c)aC.addEventListener('click',f.createClickHandler(()=>i.select(aC)));return i};